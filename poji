local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

-- 创建窗口，只包含密钥系统
local Window = WindUI:CreateWindow({
    Title = "破戟脚本",
    Icon = "rbxassetid://129260712070622",
    IconThemed = true,
    Author = "破戟脚本",
    Folder = "破戟脚本",
    Size = UDim2.fromOffset(400, 300),
    Theme = "Dark",
    
    -- 密钥系统配置
    KeySystem = {
        Key = { "1234", "5678" },
        Note = "请输入正确的密钥\n\n密钥请入q群获得732421171",
        SaveKey = true,
    },
})

-- 添加一个基础标签页作为示例
local MainSection = Window:Section({
    Title = "基础功能",
    Opened = true,
})

local MainTab = MainSection:Tab({ Title = "信息", Icon = "home" })

MainTab:Paragraph({
    Title = "欢迎使用破戟脚本",
    Desc = "欢迎使用破戟脚本(^o^)/，由于该脚本处于测试阶段，如果有问题请前往我们的q群反馈，此脚本永远免费。",
    Image = "check-circle",
})

-- 添加玩家信息部分
MainTab:Section({ Title = "玩家信息" })

-- 获取注入器信息
local executor = "未知"
local success, result = pcall(function()
    return identifyexecutor()
end)
if success and result then
    executor = result
end

MainTab:Paragraph({
    Title = "注入器信息",
    Desc = "您的注入器: " .. executor,
})

-- 获取玩家信息
local Players = game:GetService("Players")
local localPlayer = Players.LocalPlayer

MainTab:Paragraph({
    Title = "用户名",
    Desc = "您的用户名: " .. localPlayer.Name,
})

MainTab:Paragraph({
    Title = "显示名称",
    Desc = "您的显示名称: " .. localPlayer.DisplayName,
})

MainTab:Paragraph({
    Title = "服务器信息",
    Desc = "您当前服务器的ID: " .. tostring(game.GameId),
})

MainTab:Paragraph({
    Title = "用户ID",
    Desc = "您的用户ID: " .. tostring(localPlayer.UserId),
})

-- 获取客户端ID
local clientId = "未知"
local success2, result2 = pcall(function()
    return game:GetService("RbxAnalyticsService"):GetClientId()
end)
if success2 and result2 then
    clientId = result2
end

MainTab:Paragraph({
    Title = "客户端ID",
    Desc = "您的客户端ID: " .. clientId,
})

MainTab:Button({
    Title = "测试按钮",
    Desc = "这是一个基础功能测试按钮",
    Callback = function()
        WindUI:Notify({
            Title = "测试通知",
            Content = "这是一个测试通知",
            Duration = 3,
        })
    end
})

-- 创建通用功能标签页
local GeneralTab = MainSection:Tab({ Title = "通用功能", Icon = "zap" })

-- 添加玩家移动控制功能
GeneralTab:Section({ Title = "玩家移动控制" })

-- 玩家速度控制 (WalkSpeed)
local walkSpeedValue = 16
local walkSpeedEnabled = false

GeneralTab:Slider({
    Title = "玩家速度",
    Desc = "调整玩家行走速度 (speedwalk)",
    Value = { Min = 0, Max = 1000, Default = 16 },
    Callback = function(Value)
        walkSpeedValue = Value
        if walkSpeedEnabled and localPlayer.Character and localPlayer.Character:FindFirstChild("Humanoid") then
            localPlayer.Character.Humanoid.WalkSpeed = Value
        end
    end
})

GeneralTab:Toggle({
    Title = "开启速度",
    Value = false,
    Callback = function(Value) 
        walkSpeedEnabled = Value
        
        -- 创建或停止速度更新循环
        if Value then
            local speedLoop
            speedLoop = game:GetService("RunService").Heartbeat:Connect(function()
                if walkSpeedEnabled and localPlayer.Character and localPlayer.Character:FindFirstChild("Humanoid") then
                    localPlayer.Character.Humanoid.WalkSpeed = walkSpeedValue
                else
                    speedLoop:Disconnect()
                end
            end)
        end
        
        WindUI:Notify({
            Title = "破戟脚本：",
            Content = Value and "已开启速度" or "已关闭速度",
            Icon = Value and "check" or "x",
            Duration = 2
        })
    end
})

-- 玩家传送行走 (Teleport Walk)
GeneralTab:Slider({
    Title = "传送速度",
    Desc = "调整传送距离 (tpwalk)",
    Value = { Min = 0, Max = 10, Default = 0 },
    Callback = function(value)
        -- 这里只是设置值，实际功能在下面的开关中启用
        _G.TeleportDistance = value
    end
})

-- 传送行走功能开关
GeneralTab:Toggle({
    Title = "启用传送行走",
    Value = false,
    Callback = function(state)
        if state then
            -- 启用传送行走
            local character = localPlayer.Character or localPlayer.CharacterAdded:Wait()
            local humanoid = character:WaitForChild("Humanoid")
            local rootPart = character:WaitForChild("HumanoidRootPart")
            
            -- 禁用默认移动状态
            local function DisableDefaultMovement()
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Climbing, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.FallingDown, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Flying, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Freefall, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.GettingUp, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Jumping, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Landed, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Physics, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.PlatformStanding, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Ragdoll, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Running, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.RunningNoPhysics, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.StrafingNoPhysics, false)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Swimming, false)
            end
            
            -- 启用默认移动状态
            local function EnableDefaultMovement()
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Climbing, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.FallingDown, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Flying, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Freefall, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.GettingUp, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Jumping, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Landed, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Physics, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.PlatformStanding, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Ragdoll, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Running, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.RunningNoPhysics, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.StrafingNoPhysics, true)
                humanoid:SetStateEnabled(Enum.HumanoidStateType.Swimming, true)
            end
            
            -- 传送函数
            local function Teleport()
                if not rootPart or not humanoid then return end
                
                local moveDirection = humanoid.MoveDirection
                if moveDirection.Magnitude == 0 then return end
                
                local teleportDistance = _G.TeleportDistance or 0
                local teleportVector = moveDirection * teleportDistance
                
                -- 检测障碍物
                local raycastParams = RaycastParams.new()
                raycastParams.FilterDescendantsInstances = {character}
                raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
                
                local raycastResult = workspace:Raycast(rootPart.Position, teleportVector, raycastParams)
                
                if raycastResult then
                    teleportVector = (raycastResult.Position - rootPart.Position).Unit * teleportDistance
                end
                
                rootPart.CFrame = rootPart.CFrame + teleportVector
            end
            
            DisableDefaultMovement()
            local connection = game:GetService("RunService").Heartbeat:Connect(Teleport)
            
            -- 保存连接以便关闭时断开
            _G.TeleportConnection = connection
        else
            -- 禁用传送行走
            if localPlayer.Character and localPlayer.Character:FindFirstChild("Humanoid") then
                local humanoid = localPlayer.Character.Humanoid
                -- 启用默认移动状态
                local function EnableDefaultMovement()
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.Climbing, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.FallingDown, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.Flying, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.Freefall, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.GettingUp, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.Jumping, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.Landed, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.Physics, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.PlatformStanding, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.Ragdoll, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.Running, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.RunningNoPhysics, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.StrafingNoPhysics, true)
                    humanoid:SetStateEnabled(Enum.HumanoidStateType.Swimming, true)
                end
                EnableDefaultMovement()
            end
            
            -- 断开连接
            if _G.TeleportConnection then
                _G.TeleportConnection:Disconnect()
                _G.TeleportConnection = nil
            end
        end
    end
})

-- 添加分割线
GeneralTab:Divider()

GeneralTab:Section({ Title = "玩家属性调整" })

-- 玩家跳跃力
GeneralTab:Slider({
    Title = "玩家跳跃高度",
    Desc = "调整玩家跳跃力 (JumpPower)",
    Value = { Min = 0, Max = 1000, Default = 50 },
    Callback = function(value)
        if localPlayer.Character and localPlayer.Character:FindFirstChild("Humanoid") then
            localPlayer.Character.Humanoid.JumpPower = value
        end
    end
})

-- 世界重力
GeneralTab:Slider({
    Title = "世界重力",
    Desc = "调整游戏世界的重力值",
    Value = { Min = 0, Max = 1000, Default = 196.2 },
    Callback = function(value)
        workspace.Gravity = value
    end
})

-- 添加分割线
GeneralTab:Divider()

GeneralTab:Section({ Title = "视觉效果" })
